<USCalibration version="1.0">
	<!-- CalibrationMode: OFFLINE or REALTIME -->
    <CalibrationController LogLevel="INFO" OutputPath="./Output" EnableTrackedSequenceDataSaving="FALSE" EnableErroneouslySegmentedDataSaving="FALSE" EnableSegmentationAnalysis="FALSE" CalibrationMode="OFFLINE" EnableVisualization="FALSE">
        <StepperCalibration MinNumberOfRotationClusters="4" >
			<!-- TemplateTranslationData: These are the data files used to calculate the template translation axis  -->
			<TemplateTranslationData 
                    NumberOfImagesToUse="100" 
                    StartingIndex="0" 
                    SequenceMetaFile="\\image\shared_data\images\TRUSCalibration\2011-02-09_iCALDemo_TestData\TemplateTranslationData.mha"
                    />

			<!-- ProbeTranslationData: These are the data files used to calculate the stepper translation axis  -->
            <ProbeTranslationData 
                    NumberOfImagesToUse="200" 
                    StartingIndex="0" 
                    SequenceMetaFile="\\image\shared_data\images\TRUSCalibration\2011-02-09_iCALDemo_TestData\ProbeTranslationData.mha"
                    />
			
			 <!-- ProbeRotationData: These are the data files used to calculate the frame center of rotation  -->
            <ProbeRotationData 
                    NumberOfImagesToUse="500" 
                    StartingIndex="0" 
                    SequenceMetaFile="\\image\shared_data\images\TRUSCalibration\2011-02-09_iCALDemo_TestData\ProbeRotationData.mha"
                    />
		</StepperCalibration>	
		
        <ProbeCalibration
                EnableLogFile="FALSE"  
				EnableSegmentedWirePositionsSaving="FALSE"
                ImageHomeToUserImageHomeTransform=" 1  0  0  0 
                                                    0  1  0  0 
                                                    0  0  1  0 
                                                    0  0  0  1"
                DataFileSuffix=".data"
                CalibrationResultFileSuffix=".Calibration.results"
                SegmentationErrorLogFileNameSuffix=".Segmentation.errors"
                SegmentationAnalysisFileNameSuffix = ".Segmentation.analysis"
                Temp2StepCalibAnalysisFileNameSuffix = ".Template2StepperCalibration.analysis"
                >
			
			 <!-- RandomStepperMotionData1: These are the data files used for calibration. -->
            <RandomStepperMotionData1
                    NumberOfImagesToUse="300" 
                    StartingIndex="0" 
                    SequenceMetaFile="\\image\shared_data\images\TRUSCalibration\2011-02-09_iCALDemo_TestData\RandomStepperMotionData1.mha"
                    />

            <!-- RandomStepperMotionData2: These are the data files used to validate the calibration accuracy.  -->
            <RandomStepperMotionData2
                    NumberOfImagesToUse="200" 
                    StartingIndex="0" 
                    SequenceMetaFile="\\image\shared_data\images\TRUSCalibration\2011-02-09_iCALDemo_TestData\RandomStepperMotionData2.mha"
                    />

			<TemplateModel ConfigFile="../config/TemplateModel.xml" >
            </TemplateModel>

            <!-- IncorporatingUS3DBeamProfile: 0 - NO | 1 - BeamwidthVariance | 2 - BeamwidthRatio | 3 - BeamwidthVarianceAndThresholding -->
            <!-- ConfigFile: The name and the relative or absolute path of the US beam profile file -->
            <US3DBeamProfile IncorporatingUS3DBeamProfile="0" ConfigFile="./Component_US3DBeamProfile.config" />
        </ProbeCalibration>
		
		<RealtimeCalibration>
			<!-- TemplateTranslationData: These are the data files used to calculate the template translation axis  -->
			<TemplateTranslationData 
                    NumberOfImagesToAcquire="100" 
                    OutputSequenceMetaFileSuffix=".TemplateTranslationData"
                    />
			<!-- ProbeTranslationData: These are the data files used to calculate the stepper translation axis  -->
            <ProbeTranslationData 
                    NumberOfImagesToAcquire="200" 
                    OutputSequenceMetaFileSuffix=".ProbeTranslationData"
                    />
			 <!-- ProbeRotationData: These are the data files used to calculate the frame center of rotation  -->
            <ProbeRotationData 
                    NumberOfImagesToAcquire="500" 
                    OutputSequenceMetaFileSuffix=".ProbeRotationData"
                    />
			 <!-- RandomStepperMotionData1: These are the data files used for calibration. -->
            <RandomStepperMotionData1
                    NumberOfImagesToAcquire="200" 
                    OutputSequenceMetaFileSuffix=".RandomStepperMotionData1"
                    />
            <!-- RandomStepperMotionData2: These are the data files used to validate the calibration accuracy.  -->
            <RandomStepperMotionData2
                    NumberOfImagesToAcquire="100" 
                    OutputSequenceMetaFileSuffix=".RandomStepperMotionData2"
                    />
		</RealtimeCalibration>

        <!-- SearchRegionX: X-axis points to the right in pixels (there must be at least 8-pixel-wide black border outside of the search region.) -->
        <!-- SearchRegionY: Y-axis points to the bottom in pixels (there must be at least 8-pixel-wide black border outside of the search region.) -->
        <SegmentationParameters
                FrameSize="640 480"
                ScalingEstimation="0.26"
                MorphologicalOpeningCircleRadiusMm="0.55"
				MorphologicalOpeningBarSizeMm="2.0"

                SearchRegionX="50 550"
                SearchRegionY="140 300"

				MaxLineLengthErrorPercent="5.0"
				MaxLinePairDistanceErrorPercent="10.0"
                MaxLineErrorMm="2.0"

                MaxAngleDifferenceDegrees="11"
                MinThetaDegrees="20"
                MaxThetaDegrees="160"
                
                ThresholdImageTop="10.0"
                ThresholdImageBottom="10.0"

                FindLines3PtDist="5.3"

                UseOriginalImageIntensityForDotIntensityScore="0"

                PhantomDefinition="PhantomDefinition_iCal_1.0_Wiring_1.0.xml" 
                >
        </SegmentationParameters>
    </CalibrationController>
</USCalibration>