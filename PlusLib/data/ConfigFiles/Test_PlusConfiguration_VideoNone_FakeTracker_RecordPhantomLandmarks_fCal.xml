<PlusConfiguration version="1.3">

	<!-- DATA COLLECTION -->
	<USDataCollection version="2.0" StartupDelaySec="1.0">
		<DeviceSet 
			Name="TEST Simulation mode for Phantom registration" 
			Description="No Video with Fake tracker in Record phantom landmarks mode
vtkPhantomRegistrationTest uses this configuration" 
			/>

		<Tracker Type="FakeTracker" BufferSize="1000" Frequency="50" LocalTimeOffset="0.0" Mode="RecordPhantomLandmarks" AveragedItemsForFiltering="20" >
      <Tool Name="Reference" PortName="0"></Tool> 
			<!-- STYLUS -->
			<Tool Name="Stylus" PortName="1" Model="Example" SendTo="127.0.0.1:1111">
				
				<!-- ModelToToolTransform - transforming model into tool origin coordinate system for proper visualization ( Note2: All tools that are not phantoms should use ModelToToolTransform as the entity name) -->
				<Model
					File="Stylus_Example.stl"
					ModelToToolTransform="
						1 0 0 -210.0
						0 1 0 0
						0 0 1 0
						0 0 0 1"
				/>
			</Tool>
		</Tracker>

		<ImageAcquisition Type="None" />

		<Synchronization Type="ChangeDetection" 
				SynchronizationTimeLength="30" 
				MinNumOfSyncSteps="5" 
				ThresholdMultiplier="5"

				NumberOfAveragedTransforms="20" 
				MinTransformThreshold="2.0" 
				MaxTransformDifference="2.0" 

				NumberOfAveragedFrames="6" 
				MinFrameThreshold="200.0" 
				MaxFrameDifference="10.0" 
				/>
	</USDataCollection> 

  <CoordinateDefinitions>
    <Transform From="ToolTip" To="Stylus" Matrix="1 0 0 210.0474 0 1 0 -0.0521 0 0 1 -0.0000 0 0 0 1" Error="0.561812" Date="2011.07.29 17:22:12"/>      
  </CoordinateDefinitions>
  
	<!-- PHANTOM -->
	<PhantomDefinition version="1.1">
		<!-- Supported types are: Double-N, U-Shaped-N -->
		<Description
			Name="fCAL"
			Type="Double-N"
			Version="1.0"
			Institution="Queen's University PerkLab"
		/>
		
		<!-- ModelToPhantomTransform - transforming model into phantom coordinate system for proper visualization -->
		<Model
			File="FCal_1.0.stl"
			ModelToPhantomTransform="
				1 0 0 -15.0
				0 1 0 10.0
				0 0 1 -5.0
				0 0 0 1"
		/>

		<Geometry>
			<!-- N wire definitions -->
			<Pattern Type="NWire">
				<Wire Name="1:E3_e3" EndPointFront="20.0 0.0 5.0" EndPointBack="20.0 40.0 5.0" />
				<Wire Name="2:F3_j3" EndPointFront="25.0 0.0 5.0" EndPointBack="45.0 40.0 5.0" />
				<Wire Name="3:K3_k3" EndPointFront="50.0 0.0 5.0" EndPointBack="50.0 40.0 5.0" />
			</Pattern>
			<Pattern Type="NWire">
				<Wire Name="4:E4_e4" EndPointFront="20.0 0.0 0.0" EndPointBack="20.0 40.0 0.0" />
				<Wire Name="5:J4_f4" EndPointFront="45.0 0.0 0.0" EndPointBack="25.0 40.0 0.0" />
				<Wire Name="6:K4_k4" EndPointFront="50.0 0.0 0.0" EndPointBack="50.0 40.0 0.0" />
			</Pattern>

			<!-- Landmark list for registration -->
			<Landmarks>
				<Landmark Name="#1" Position="95.0 5.0 15.0" />
				<Landmark Name="#2" Position="95.0 40.0 15.0" />
				<Landmark Name="#3" Position="95.0 40.0 0.0" />
				<Landmark Name="#4" Position="95.0 0.0 0.0" />
				
				<Landmark Name="#5" Position="-25.0 40.0 15.0" />
				<Landmark Name="#6" Position="-25.0 0.0 10.0" />
				<Landmark Name="#7" Position="-25.0 0.0 0.0" />
				<Landmark Name="#8" Position="-25.0 40.0 0.0" />
			</Landmarks>
			
			<Registration
				MatrixName="PhantomToPhantomReference" 
				MatrixValue="1 0 0 0 
							 0 1 0 0 
							 0 0 1 0
							 0 0 0 1" 
				Date=""
				Error="0.0" />
		</Geometry>
	</PhantomDefinition>

  <fCal NumberOfCalibrationImagesToAcquire="200">
    <TrackerToolNames
      Reference="Reference"
      Probe="Probe"
      Stylus="Stylus"
    />
  </fCal>
  
</PlusConfiguration>