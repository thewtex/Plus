<PlusConfiguration version="2.0">

  <DataCollection StartupDelaySec="1.0" >
    <DeviceSet 
      Name="TEST Media Foundation WebCam with Fake tracker" 
      Description="Test mode for vtkDataCollectorTest with MmfVideo (Microsoft Media Foundation image capturing device) and Fake tracker" 
    />

    <Device
      Id="TrackerDevice"
      Type="FakeTracker"
      AcquisitionRate="20"
      LocalTimeOffset="0.0"
      Mode="SmoothMove"
      ToolReferenceFrame="TrackerDevice" >
      <DataSources>
        <DataSource Type="Tool" Id="Probe" PortName="0" BufferSize="1000" AveragedItemsForFiltering="20"/> 
        <DataSource Type="Tool" Id="Reference" PortName="1" BufferSize="1000" AveragedItemsForFiltering="20"/>
        <DataSource Type="Tool" Id="MissingTool" PortName="2" BufferSize="1000" AveragedItemsForFiltering="20"/>       
      </DataSources>
      
      <OutputChannels>
        <OutputChannel Id="TrackerStream" >
          <DataSource Type="Tool" Id="Probe"/>
          <DataSource Type="Tool" Id="Reference"/>
          <DataSource Type="Tool" Id="MissingTool"/>
        </OutputChannel>
      </OutputChannels>
    </Device>

    <Device
      Id="VideoDevice" 
      Type="MmfVideo" >
      <DataSources>
        <DataSource Type="Video" Id="Video" PortUsImageOrientation="MF" BufferSize="100" AveragedItemsForFiltering="20" />     
      </DataSources>
      
      <OutputChannels>
        <OutputChannel Id="VideoStream" VideoDataSourceId="Video" />
      </OutputChannels>
    </Device>

    <Device 
      Id="TrackedVideoDevice" 
      Type="VirtualMixer" >
      <InputChannels>
        <InputChannel Id="TrackerStream" />
        <InputChannel Id="VideoStream" />
      </InputChannels>

      <OutputChannels>
        <OutputChannel Id="TrackedVideoStream"/>
      </OutputChannels>
    </Device>
    
  </DataCollection>

 <CoordinateDefinitions>
    <Transform From="Image" To="Probe"
      Matrix="0.00156166 0.0726639 -0.00948114 11.3389 
      -0.0779562 0.00257007 0.00812248 46.115 
      0.00866095 0.00892904 0.074819 -7.23141 
      0 0 0 1" 
      />
    <Transform From="Phantom" To="Reference" Matrix="0.00898765 -0.0136951 -0.999866 9.59137 0.0246163 -0.9996 0.0139127 36.0012 -0.999657 -0.024738 -0.00864693 87.8909 0 0 0 1" Error="0.404711" Date="012712_152104" />
  </CoordinateDefinitions>
    
  <Rendering WorldCoordinateFrame="Reference" DisplayedImageOrientation="MF">
    <xDisplayableObject Type="Model" ObjectCoordinateFrame="Probe" Id="ProbeModel"
      File="L14-5_38_ProbeModel.stl"
      ModelToObjectTransform="
        -1 0 0 29.7
        0 -1 0 1.5
        0 0 1 -14
        0 0 0 1"
    />
    <DisplayableObject Type="Image" ObjectCoordinateFrame="Image" Id="LiveImage"/>
  </Rendering>

  <fCal
    PhantomModelId="PhantomModel"
    TransducerModelId="ProbeModel"
    StylusModelId="StylusModel"
    ImageDisplayableObjectId="LiveImage"
    NumberOfStylusCalibrationPointsToAcquire="200"
    ImageCoordinateFrame="Image"
    ProbeCoordinateFrame="Probe"
    ReferenceCoordinateFrame="Reference"
    TransducerOriginCoordinateFrame="TransducerOrigin"
    TransducerOriginPixelCoordinateFrame="TransducerOriginPixel"
    DefaultSelectedChannelId="TrackedVideoStream"
  />

</PlusConfiguration>
