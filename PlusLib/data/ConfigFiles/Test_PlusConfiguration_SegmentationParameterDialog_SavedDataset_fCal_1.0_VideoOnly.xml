<PlusConfiguration version="1.3">

	<!-- DATA COLLECTION -->
	<USDataCollection version="2.0" StartupDelaySec="1.0">
		<DeviceSet 
			Name="TEST SegmentationParameterDialogTest - Saved dataset for video only" 
			Description="Saved dataset for video only" 
			/>

		<Tracker Type="None"/>

		<ImageAcquisition Type="SavedDataset" 
				BufferSize="200" 
				FrameSize="820 616" 
				FrameRate="10" 
				AveragedItemsForFiltering="20" 
				LocalTimeOffset="0.12" 
				SequenceMetafile="AllSegmentablefCal.mha"
				UsImageOrientation="MF"
				ReplayEnabled="TRUE"
        SpeedThresholdPositionMm="10.0"
        SpeedThresholdOrientationAngle="15.0"
				/>

		<Synchronization Type="ChangeDetection" 
				SynchronizationTimeLength="30" 
				MinNumOfSyncSteps="5" 
				ThresholdMultiplier="5"

				NumberOfAveragedTransforms="20" 
				MinTransformThreshold="2.0" 
				MaxTransformDifference="2.0" 

				NumberOfAveragedFrames="6" 
				MinFrameThreshold="200.0" 
				MaxFrameDifference="10.0" 
				/>
	</USDataCollection>

	<!-- CALIBRATION -->
	<USCalibration>
		<CalibrationController>
			<ProbeCalibration />
			
			<SegmentationParameters
					ApproximateSpacingMmPerPixel="0.078"
					MorphologicalOpeningCircleRadiusMm="0.47"
					MorphologicalOpeningBarSizeMm="1.0"

					RegionOfInterest="27 27 793 589"

					MaxLinePairDistanceErrorPercent="10.0"

					MaxAngleDifferenceDegrees="11"
					MinThetaDegrees="-70"
					MaxThetaDegrees="70"
					
          AngleToleranceDegrees="10"

					ThresholdImagePercent="10.0"

					CollinearPointsMaxDistanceFromLineMm="0.41"

					UseOriginalImageIntensityForDotIntensityScore="0"
					>
			</SegmentationParameters>
		</CalibrationController>
	</USCalibration>
	
	<!-- PHANTOM -->
	<PhantomDefinition version="1.1">
		<!-- Supported types are: Double-N, U-Shaped-N -->
		<Description
			Name="fCAL"
			Type="Double-N"
			Version="1.0"
			Institution="Queen's University PerkLab"
		/>
		
		<!-- ModelToPhantomTransform - transforming model into phantom coordinate system for proper visualization -->
		<Model
			File="FCal_1.0.stl"
			ModelToPhantomTransform="
				1 0 0 -15.0
				0 1 0 10.0
				0 0 1 -5.0
				0 0 0 1"
		/>

		<Geometry>
			<!-- N wire definitions -->
			<Pattern Type="NWire">
				<Wire Name="1:E3_e3" EndPointFront="20.0 0.0 5.0" EndPointBack="20.0 40.0 5.0" />
				<Wire Name="2:F3_j3" EndPointFront="25.0 0.0 5.0" EndPointBack="45.0 40.0 5.0" />
				<Wire Name="3:K3_k3" EndPointFront="50.0 0.0 5.0" EndPointBack="50.0 40.0 5.0" />
			</Pattern>
			<Pattern Type="NWire">
				<Wire Name="4:E4_e4" EndPointFront="20.0 0.0 0.0" EndPointBack="20.0 40.0 0.0" />
				<Wire Name="5:J4_f4" EndPointFront="45.0 0.0 0.0" EndPointBack="25.0 40.0 0.0" />
				<Wire Name="6:K4_k4" EndPointFront="50.0 0.0 0.0" EndPointBack="50.0 40.0 0.0" />
			</Pattern>

			<!-- Landmark list for registration -->
			<Landmarks>
				<Landmark Name="#1" Position="95.0 5.0 15.0" />
				<Landmark Name="#2" Position="95.0 40.0 15.0" />
				<Landmark Name="#3" Position="95.0 40.0 0.0" />
				<Landmark Name="#4" Position="95.0 0.0 0.0" />
				
				<Landmark Name="#5" Position="-25.0 40.0 15.0" />
				<Landmark Name="#6" Position="-25.0 0.0 10.0" />
				<Landmark Name="#7" Position="-25.0 0.0 0.0" />
				<Landmark Name="#8" Position="-25.0 40.0 0.0" />
			</Landmarks>
			
			<Registration
				MatrixName="PhantomToPhantomReference" 
				MatrixValue="
					0.9955 -0.0286 -0.0898 -35.8654
          0.0902 0.0125 0.9958 -125.0523
          -0.0273 -0.9995 0.0150 -15.0
          0 0 0 1"
        Date="2011.08.03 14:20:09"
        Error="-1"/>

		</Geometry>
	</PhantomDefinition>

	<!-- VOLUME RECONSTRUCTION -->
	<VolumeReconstruction>
		<SliceParameters SliceSpacing="1 1 1" SliceOrigin="0 0 0" NumScalarComponents="1" />

		<OutputParameters OutputSpacing="0.5 0.5 0.5" />

		<ClippingParameters ClipRectangle="0 0 820 616"/>
		<FanParameters FanAngles="0 0" FanOrigin="0 0" FanDepth="300"/>
		<RotationOptions ImageFlipped="Off" Rotation="Off" MaxRotationChange="90" Threshold1="0" Threshold2="255" ShiftX="0" ShiftY="0" />
		<ReconstructionOptions Interpolation="Linear" Optimization="On" Compounding="On"/>
	</VolumeReconstruction>

</PlusConfiguration>